<mat-sidenav-container [hasBackdrop]="false" autosize scrollable>
  <mat-sidenav-content>
    <div class="board-header">
      <a mat-button mat-stroked-button color="primary" routerLink=".." class="back-btn"><--</a>
      <div class="board-name">{{ (selectedBoard$ | async)?.name }}</div>
      <span class="flex-spacer"></span>
      <button mat-icon-button aria-label="More board options" class="more-btn" [matMenuTriggerFor]="boardMenu">
        <mat-icon [inline]="true">more_horiz</mat-icon>
      </button>
    </div>

    <div class="top-bar">
      <div class="tasks-search">
        <form class="example-form" (keydown.enter)="$event.preventDefault()">
          <mat-form-field appearance="outline">
            <mat-label>{{ 'auth.SearchTask' | transloco }}</mat-label>
            <input type="text" matInput [formControl]="filterTextControl">
            <mat-icon matSuffix>search</mat-icon>
          </mat-form-field>
        </form>
      </div>
      <div class="users-list">
        <div
          class="users-list__item"
          *ngFor="let user of users"
          [style.background-image]="getUserImgStyle(user)"
          [matTooltip]="user.email"
        >
        </div>
      </div>
    </div>

    <div class="columns-list" cdkDropListGroup>
      <div *ngFor="let col of columns$ | async" class="column">
        <p class="column__title">{{ col.name }}</p>
        <div
          class="column__tasks"
          cdkDropList
          [cdkDropListData]="col.tasks"
          (cdkDropListDropped)="onDropTask($event, col._id)"
        >
          <mat-card
            *ngFor="let task of col.tasks"
            cdkDrag
            (cdkDragStarted)="onDragToggle(true)"
            (cdkDragReleased)="onDragToggle(false)"
            (click)="toggleTaskSidebar(true, task);"
          >
            {{ task.title }}
          </mat-card>
        </div>
      </div>
    </div>

    <div class="actions">
      <button
        class="add-task"
        mat-fab
        aria-label="Add a board"
        [matTooltip]="'auth.CreateTask' | transloco"
        matTooltipPosition="left"
        (click)="createTask()"
      >
        <mat-icon>add</mat-icon>
      </button>
    </div>
  </mat-sidenav-content>


  <mat-sidenav #drawer mode="over" position="end" class="task-sidebar">
    <div class="task-sidebar__actions">
      <button mat-icon-button aria-label="Open in new tab">
        <mat-icon>open_in_new</mat-icon>
      </button>

      <button mat-icon-button aria-label="Close task sidebar" (click)="toggleTaskSidebar(false)">
        <mat-icon>close</mat-icon>
      </button>
    </div>
    <h1>{{ selectedTask?.title }}</h1>
    <hr/>
    <div class="task-sidebar__dates">
      <p>Created at: <i>{{ selectedTask?.createdAt | date }}</i></p>
      <p>Updated at: <i>{{ selectedTask?.updatedAt | date }}</i></p>
    </div>
    <hr/>
    <div>
      {{ selectedTask?.body }}
      <i *ngIf="!selectedTask?.body">Here is no description...</i>
    </div>
  </mat-sidenav>

</mat-sidenav-container>

<mat-menu #boardMenu="matMenu">
  <button mat-menu-item>
    <mat-icon>group</mat-icon>
    <span>{{ 'auth.TeamManagement' | transloco }}</span>
  </button>
</mat-menu>
